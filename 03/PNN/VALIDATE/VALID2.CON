;  This tests all three output modes of the SEPVAR model

NETWORK MODEL = SEPVAR
KERNEL = GAUSS
RUN OUTPUT = valid2.asc

;  Start out in MAPPING mode.  Train to the limit and save the network.

MODE = MAPPING

INPUTS = 2
OUTPUTS = 2

CUMULATE TRAINING SET = test1.dat
CUMULATE TRAINING SET = test2.dat

ALLOWABLE ERROR = 0.0
SIGMA LOW = 0.003
SIGMA HIGH = 5.0
SIGMA TRIES = 5
COMPUTE WEIGHTS

TEST NETWORK WITH INPUT = test1.dat
TEST NETWORK WITH INPUT = test2.dat
RUN NETWORK WITH INPUT = test1.dat
RUN NETWORK WITH INPUT = test2.dat
SAVE NETWORK = valid2a.wts
ERASE NETWORK
ERASE TRAINING SET


;  Now switch to AUTOASSOCIATION mode

MODE = AUTOASSOCIATION

INPUTS = 4
OUTPUTS = 4

CUMULATE TRAINING SET = test1.dat
CUMULATE TRAINING SET = test2.dat

COMPUTE WEIGHTS

TEST NETWORK WITH INPUT = test1.dat
TEST NETWORK WITH INPUT = test2.dat
RUN NETWORK WITH INPUT = test1.dat
RUN NETWORK WITH INPUT = test2.dat
SAVE NETWORK = valid2b.wts
ERASE NETWORK
ERASE TRAINING SET

;  Finally, go to CLASSIFICATION mode

MODE = CLASSIFICATION

INPUTS = 2
OUTPUTS = 2

CLASS = 1
CUMULATE TRAINING SET = test1.dat

CLASS = 2
CUMULATE TRAINING SET = test2.dat

COMPUTE WEIGHTS

ZERO CONFUSION ROW
CLASSIFY WITH INPUT = test1.dat
LIST CONFUSION ROW
ZERO CONFUSION ROW
CLASSIFY WITH INPUT = test2.dat
LIST CONFUSION ROW
RUN NETWORK WITH INPUT = test1.dat
RUN NETWORK WITH INPUT = test2.dat
SAVE NETWORK = valid2c.wts
ERASE NETWORK
ERASE TRAINING SET

;  Networks in all three modes have been trained and saved.
;  Read back the MAPPING network.  Test it to verify identical results,
;  then train again.  Nothing significant should change, as we already
;  trained it to the limit.  Test it to verify that.

RESTORE NETWORK = valid2a.wts

TEST NETWORK WITH INPUT = test1.dat
TEST NETWORK WITH INPUT = test2.dat
RUN NETWORK WITH INPUT = test1.dat
RUN NETWORK WITH INPUT = test2.dat

CUMULATE TRAINING SET = test1.dat
CUMULATE TRAINING SET = test2.dat

COMPUTE WEIGHTS

TEST NETWORK WITH INPUT = test1.dat
TEST NETWORK WITH INPUT = test2.dat
RUN NETWORK WITH INPUT = test1.dat
RUN NETWORK WITH INPUT = test2.dat
ERASE NETWORK
ERASE TRAINING SET

;  Now do the same for the AUTOASSOCIATION network

RESTORE NETWORK = valid2b.wts

TEST NETWORK WITH INPUT = test1.dat
TEST NETWORK WITH INPUT = test2.dat
RUN NETWORK WITH INPUT = test1.dat
RUN NETWORK WITH INPUT = test2.dat

CUMULATE TRAINING SET = test1.dat
CUMULATE TRAINING SET = test2.dat

COMPUTE WEIGHTS

TEST NETWORK WITH INPUT = test1.dat
TEST NETWORK WITH INPUT = test2.dat
RUN NETWORK WITH INPUT = test1.dat
RUN NETWORK WITH INPUT = test2.dat
ERASE NETWORK
ERASE TRAINING SET

;  Finally, do the CLASSIFICATION network

RESTORE NETWORK = valid2c.wts

RUN NETWORK WITH INPUT = test1.dat
RUN NETWORK WITH INPUT = test2.dat

CLASS = 1
CUMULATE TRAINING SET = test1.dat

CLASS = 2
CUMULATE TRAINING SET = test2.dat

COMPUTE WEIGHTS

ZERO CONFUSION ROW
CLASSIFY WITH INPUT = test1.dat
LIST CONFUSION ROW
ZERO CONFUSION ROW
CLASSIFY WITH INPUT = test2.dat
LIST CONFUSION ROW
RUN NETWORK WITH INPUT = test1.dat
RUN NETWORK WITH INPUT = test2.dat
ERASE NETWORK
ERASE TRAINING SET
BYE
