;  Test MLFN domains
;  For a truly thorough test, both LM and CJ learning should be done

;  Please note that the class1.dat and class2.dat files have been carefully
;  designed to produce an excellent global minimum EXTREMELY well hidden
;  among a multitude of poor local minima.  The learning algorithms in this
;  test suite will be stressed to the limit, and beyond.  The hybrid methods
;  will exhibit many time consuming escapes, far more than is natural for
;  most problems.  Also, results of these tests are very much affected by
;  the state of the random number generator, as relatively few stochastic
;  iterations are done.  Do not be discouraged by all this.  The data used
;  here is not representative of most real-life data.  This is a stress test.

PROGRESS ON
ALLOWABLE ERROR = 0.0
THRESHOLD = 50

;  Read the data

NAME = A1, A2, A3, A4, A5, A6
READ SIGNAL FILE = class1.dat
NAME = B1, B2, B3, B4, B5, B6
READ SIGNAL FILE = class2.dat


NETWORK MODEL = MLFN
MLFN ERROR TYPE = MEAN SQUARE
THRESHOLD = 50

MLFN RESTARTS = 1
MLFN PRETRIES = 2
ACCURACY = 5
REFINE = 2

ANNEALING INITIALIZATION TEMPERATURES = 3
ANNEALING INITIALIZATION ITERATIONS = 20
ANNEALING INITIALIZATION SETBACK = 20
ANNEALING INITIALIZATION START = 2.0
ANNEALING INITIALIZATION STOP = 0.5
ANNEALING INITIALIZATION RANDOM = GAUSS
ANNEALING INITIALIZATION REDUCTION = EXPONENTIAL
ANNEALING INITIALIZATION ACCEPT = CLIMB

ANNEALING ESCAPE TEMPERATURES = 2
ANNEALING ESCAPE ITERATIONS = 10
ANNEALING ESCAPE SETBACK = 0
ANNEALING ESCAPE START = 2.0
ANNEALING ESCAPE STOP = 0.1
ANNEALING ESCAPE RANDOM = CAUCHY
ANNEALING ESCAPE REDUCTION = EXPONENTIAL
ANNEALING ESCAPE ACCEPT = CLIMB

;  First block of tests is in classification mode
;  Cumulate the training set

INPUT = A1
INPUT = A2
INPUT = A3
INPUT = A4
CLASS = class1
CUMULATE TRAINING SET
CUMULATE TEST SET
CLEAR INPUT LIST
INPUT = B1
INPUT = B2
INPUT = B3
INPUT = B4
CLASS = class2
CUMULATE TRAINING SET
CUMULATE TEST SET

MLFN HID 1 = 0
MLFN HID 2 = 0
MLFN OUTPUT ACTIVATION = NONLINEAR
MLFN LEARNING METHOD = REGRESS_LM

MLFN DOMAIN = REAL ;
TRAIN NETWORK = temp
TEST NETWORK = temp
SAVE NETWORK = temp TO mlfn00cr.wts
PRINT NETWORK = temp TO mlfn00cr.prn
CLEAR NETWORK = temp

MLFN DOMAIN = COMPLEX INPUT ;
TRAIN NETWORK = temp
TEST NETWORK = temp
SAVE NETWORK = temp TO mlfn00ci.wts
PRINT NETWORK = temp TO mlfn00ci.prn
CLEAR NETWORK = temp

MLFN OUTPUT ACTIVATION = LINEAR
MLFN LEARNING METHOD = AN1_LM

MLFN HID 1 = 2

MLFN DOMAIN = REAL ;
TRAIN NETWORK = temp
TEST NETWORK = temp
SAVE NETWORK = temp TO mlfn20cr.wts
PRINT NETWORK = temp TO mlfn20cr.prn
CLEAR NETWORK = temp

MLFN DOMAIN = COMPLEX INPUT
TRAIN NETWORK = temp
TEST NETWORK = temp
SAVE NETWORK = temp TO mlfn20ci.wts
PRINT NETWORK = temp TO mlfn20ci.prn
CLEAR NETWORK = temp

MLFN DOMAIN = COMPLEX HIDDEN
TRAIN NETWORK = temp
TEST NETWORK = temp
SAVE NETWORK = temp TO mlfn20ch.wts
PRINT NETWORK = temp TO mlfn20ch.prn
CLEAR NETWORK = temp

;  CLASSIFICATION mode has been tested.
;  Now use MAPPING.

CLEAR TRAINING SET
CLEAR TEST SET
CLEAR CLASSES
CLEAR INPUT LIST
CLEAR OUTPUT LIST

INPUT = A1
INPUT = A2
INPUT = A3
INPUT = A4
OUTPUT = A5
OUTPUT = A6
CUMULATE TRAINING SET
CUMULATE TEST SET
CLEAR INPUT LIST
CLEAR OUTPUT LIST
INPUT = B1
INPUT = B2
INPUT = B3
INPUT = B4
OUTPUT = B5
OUTPUT = B6
CUMULATE TRAINING SET
CUMULATE TEST SET

MLFN HID 1 = 0
MLFN HID 2 = 0
MLFN OUTPUT ACTIVATION = NONLINEAR
MLFN LEARNING METHOD = REGRESS_LM

MLFN DOMAIN = REAL ;
TRAIN NETWORK = temp
TEST NETWORK = temp
SAVE NETWORK = temp TO mlfn00mr.wts
PRINT NETWORK = temp TO mlfn00mr.prn
CLEAR NETWORK = temp

MLFN DOMAIN = COMPLEX INPUT ;
TRAIN NETWORK = temp
TEST NETWORK = temp
SAVE NETWORK = temp TO mlfn00mc.wts
PRINT NETWORK = temp TO mlfn00mc.prn
CLEAR NETWORK = temp

MLFN OUTPUT ACTIVATION = LINEAR
MLFN LEARNING METHOD = AN1_LM

MLFN HID 1 = 2

MLFN DOMAIN = REAL ;
TRAIN NETWORK = temp
TEST NETWORK = temp
SAVE NETWORK = temp TO mlfn20mr.wts
PRINT NETWORK = temp TO mlfn20mr.prn
CLEAR NETWORK = temp

MLFN DOMAIN = COMPLEX INPUT
TRAIN NETWORK = temp
TEST NETWORK = temp
SAVE NETWORK = temp TO mlfn20mi.wts
PRINT NETWORK = temp TO mlfn20mi.prn
CLEAR NETWORK = temp

MLFN DOMAIN = COMPLEX HIDDEN
TRAIN NETWORK = temp
TEST NETWORK = temp
SAVE NETWORK = temp TO mlfn20mh.wts
PRINT NETWORK = temp TO mlfn20mh.prn
CLEAR NETWORK = temp

MLFN DOMAIN = COMPLEX
TRAIN NETWORK = temp
TEST NETWORK = temp
SAVE NETWORK = temp TO mlfn20mc.wts
PRINT NETWORK = temp TO mlfn20mc.prn
CLEAR NETWORK = temp

;  Now quickly finish up by going back to classification mode.
;  But this time use just one output, as class / reject

CLEAR INPUT LIST
CLEAR OUTPUT LIST
CLEAR TRAINING SET
CLEAR TEST SET
CLEAR CLASSES

;  Cumulate the training set

INPUT = A1
INPUT = A2
INPUT = A3
INPUT = A4
CLASS = reject
CUMULATE TRAINING SET
CUMULATE TEST SET
CLEAR INPUT LIST
INPUT = B1
INPUT = B2
INPUT = B3
INPUT = B4
CLASS = class
CUMULATE TRAINING SET
CUMULATE TEST SET

MLFN HID 1 = 0
MLFN HID 2 = 0
MLFN OUTPUT ACTIVATION = NONLINEAR
MLFN LEARNING METHOD = REGRESS_LM

MLFN DOMAIN = REAL ;
TRAIN NETWORK = temp
TEST NETWORK = temp
SAVE NETWORK = temp TO mlfn00xr.wts
PRINT NETWORK = temp TO mlfn00xr.prn
CLEAR NETWORK = temp

MLFN DOMAIN = COMPLEX INPUT ;
TRAIN NETWORK = temp
TEST NETWORK = temp
SAVE NETWORK = temp TO mlfn00xi.wts
PRINT NETWORK = temp TO mlfn00xi.prn
CLEAR NETWORK = temp

MLFN OUTPUT ACTIVATION = LINEAR
MLFN LEARNING METHOD = AN1_LM

MLFN HID 1 = 2

MLFN DOMAIN = REAL ;
TRAIN NETWORK = temp
TEST NETWORK = temp
SAVE NETWORK = temp TO mlfn20xr.wts
PRINT NETWORK = temp TO mlfn20xr.prn
CLEAR NETWORK = temp

MLFN DOMAIN = COMPLEX INPUT
TRAIN NETWORK = temp
TEST NETWORK = temp
SAVE NETWORK = temp TO mlfn20xi.wts
PRINT NETWORK = temp TO mlfn20xi.prn
CLEAR NETWORK = temp

MLFN DOMAIN = COMPLEX HIDDEN
TRAIN NETWORK = temp
TEST NETWORK = temp
SAVE NETWORK = temp TO mlfn20xh.wts
PRINT NETWORK = temp TO mlfn20xh.prn
CLEAR NETWORK = temp

;  Finally, restore and retest all networks

CLEAR TRAINING SET
CLEAR TEST SET
CLEAR CLASSES
CLEAR INPUT LIST
CLEAR OUTPUT LIST

INPUT = A1
INPUT = A2
INPUT = A3
INPUT = A4
CLASS = class1
CUMULATE TRAINING SET
CUMULATE TEST SET
CLEAR INPUT LIST
INPUT = B1
INPUT = B2
INPUT = B3
INPUT = B4
CLASS = class2
CUMULATE TRAINING SET
CUMULATE TEST SET

RESTORE NETWORK = temp FROM mlfn00cr.wts
TEST NETWORK = temp
RESTORE NETWORK = temp FROM mlfn00ci.wts
TEST NETWORK = temp
RESTORE NETWORK = temp FROM mlfn20cr.wts
TEST NETWORK = temp
RESTORE NETWORK = temp FROM mlfn20ci.wts
TEST NETWORK = temp
RESTORE NETWORK = temp FROM mlfn20ch.wts
TEST NETWORK = temp

CLEAR TRAINING SET
CLEAR TEST SET
CLEAR CLASSES
CLEAR INPUT LIST
CLEAR OUTPUT LIST

INPUT = A1
INPUT = A2
INPUT = A3
INPUT = A4
OUTPUT = A5
OUTPUT = A6
CUMULATE TRAINING SET
CUMULATE TEST SET
CLEAR INPUT LIST
CLEAR OUTPUT LIST
INPUT = B1
INPUT = B2
INPUT = B3
INPUT = B4
OUTPUT = B5
OUTPUT = B6
CUMULATE TRAINING SET
CUMULATE TEST SET

RESTORE NETWORK = temp FROM mlfn00mr.wts
TEST NETWORK = temp
RESTORE NETWORK = temp FROM mlfn00mc.wts
TEST NETWORK = temp
RESTORE NETWORK = temp FROM mlfn20mr.wts
TEST NETWORK = temp
RESTORE NETWORK = temp FROM mlfn20mi.wts
TEST NETWORK = temp
RESTORE NETWORK = temp FROM mlfn20mh.wts
TEST NETWORK = temp
RESTORE NETWORK = temp FROM mlfn20mc.wts
TEST NETWORK = temp


CLEAR INPUT LIST
CLEAR OUTPUT LIST
CLEAR TRAINING SET
CLEAR TEST SET
CLEAR CLASSES

;  Cumulate the training set

INPUT = A1
INPUT = A2
INPUT = A3
INPUT = A4
CLASS = reject
CUMULATE TRAINING SET
CUMULATE TEST SET
CLEAR INPUT LIST
INPUT = B1
INPUT = B2
INPUT = B3
INPUT = B4
CLASS = class
CUMULATE TRAINING SET
CUMULATE TEST SET

RESTORE NETWORK = temp FROM mlfn00xr.wts
TEST NETWORK = temp
RESTORE NETWORK = temp FROM mlfn00xi.wts
TEST NETWORK = temp
RESTORE NETWORK = temp FROM mlfn20xr.wts
TEST NETWORK = temp
RESTORE NETWORK = temp FROM mlfn20xi.wts
TEST NETWORK = temp
RESTORE NETWORK = temp FROM mlfn20xh.wts
TEST NETWORK = temp
